C:\Users\97253\AppData\Local\Programs\Python\Python311\python.exe "C:\Users\97253\OneDrive\שולחן העבודה\final project\Sketches-main\src\Quntize_one_layer_vector.py"
original x:tensor([ 6.5657e-01,  2.0000e+00,  1.0000e+03, -4.0000e+00, -5.0000e-01,
         6.1100e+00,  7.0000e+00,  8.0000e+00, -1.0000e+03,  4.5000e-01])
Original Weights:
[-0.313 -0.308 -0.306 -0.306 -0.302 -0.3   -0.297 -0.297 -0.296 -0.292
 -0.291 -0.29  -0.287 -0.287 -0.286 -0.285 -0.285 -0.284 -0.279 -0.278
 -0.278 -0.277 -0.275 -0.274 -0.274 -0.274 -0.272 -0.272 -0.27  -0.264
 -0.261 -0.26  -0.253 -0.25  -0.249 -0.249 -0.246 -0.246 -0.245 -0.245
 -0.243 -0.242 -0.241 -0.24  -0.24  -0.234 -0.231 -0.23  -0.23  -0.226
 -0.224 -0.219 -0.218 -0.216 -0.212 -0.21  -0.21  -0.206 -0.206 -0.204
 -0.203 -0.2   -0.196 -0.195 -0.194 -0.194 -0.194 -0.187 -0.185 -0.182
 -0.181 -0.178 -0.178 -0.177 -0.176 -0.175 -0.171 -0.164 -0.164 -0.161
 -0.16  -0.159 -0.159 -0.154 -0.149 -0.149 -0.149 -0.146 -0.144 -0.142
 -0.141 -0.141 -0.137 -0.136 -0.135 -0.135 -0.132 -0.124 -0.123 -0.123
 -0.121 -0.121 -0.119 -0.119 -0.117 -0.115 -0.114 -0.109 -0.106 -0.103
 -0.102 -0.101 -0.1   -0.098 -0.096 -0.093 -0.091 -0.09  -0.089 -0.088
 -0.088 -0.088 -0.084 -0.084 -0.081 -0.081 -0.08  -0.078 -0.078 -0.074
 -0.072 -0.072 -0.071 -0.067 -0.066 -0.065 -0.064 -0.063 -0.062 -0.054
 -0.053 -0.052 -0.046 -0.045 -0.045 -0.043 -0.041 -0.038 -0.03  -0.029
 -0.025 -0.023 -0.019 -0.019 -0.018 -0.013 -0.01  -0.01  -0.008 -0.007
  0.001  0.002  0.003  0.004  0.005  0.012  0.015  0.015  0.018  0.018
  0.018  0.018  0.021  0.023  0.028  0.033  0.034  0.037  0.037  0.039
  0.04   0.046  0.049  0.049  0.05   0.051  0.053  0.055  0.056  0.056
  0.06   0.062  0.063  0.064  0.068  0.069  0.08   0.083  0.084  0.086
  0.091  0.093  0.097  0.098  0.1    0.1    0.101  0.104  0.106  0.111
  0.114  0.115  0.117  0.12   0.123  0.124  0.127  0.135  0.136  0.137
  0.141  0.152  0.153  0.154  0.159  0.16   0.162  0.166  0.17   0.171
  0.175  0.177  0.177  0.183  0.187  0.191  0.196  0.196  0.197  0.197
  0.198  0.2    0.201  0.201  0.201  0.203  0.204  0.205  0.205  0.205
  0.206  0.208  0.208  0.209  0.216  0.217  0.22   0.222  0.222  0.223
  0.224  0.227  0.232  0.232  0.235  0.235  0.235  0.236  0.239  0.244
  0.245  0.246  0.246  0.249  0.25   0.25   0.25   0.251  0.251  0.251
  0.257  0.26   0.261  0.262  0.264  0.27   0.271  0.272  0.281  0.284
  0.288  0.289  0.295  0.303  0.309  0.311  0.312  0.312  0.314  0.315]
quantizedVec=[-64270 -63413 -62951 -62838 -62020 -61759 -61016 -60981 -60761 -60094
 -59809 -59657 -58985 -58902 -58711 -58540 -58506 -58350 -57368 -57239
 -57090 -56933 -56527 -56292 -56290 -56264 -55979 -55872 -55590 -54185
 -53563 -53511 -52024 -51350 -51260 -51141 -50632 -50575 -50312 -50270
 -50004 -49679 -49503 -49285 -49245 -48039 -47466 -47240 -47192 -46449
 -46029 -44990 -44843 -44388 -43516 -43273 -43245 -42403 -42368 -41871
 -41734 -41053 -40301 -40094 -39966 -39831 -39796 -38519 -38066 -37344
 -37174 -36586 -36525 -36288 -36100 -35916 -35073 -33780 -33617 -33187
 -32943 -32744 -32722 -31562 -30723 -30679 -30626 -29967 -29590 -29137
 -29074 -28886 -28204 -27954 -27790 -27741 -27126 -25440 -25353 -25237
 -24928 -24817 -24439 -24405 -24038 -23649 -23451 -22458 -21797 -21176
 -21040 -20815 -20473 -20210 -19816 -19070 -18741 -18491 -18300 -18120
 -18105 -18049 -17257 -17232 -16732 -16664 -16347 -16102 -15999 -15218
 -14899 -14801 -14494 -13678 -13644 -13366 -13058 -12918 -12729 -11163
 -10916 -10603  -9503  -9212  -9183  -8780  -8470  -7815  -6184  -5894
  -5082  -4829  -4008  -3975  -3757  -2586  -2093  -2088  -1690  -1366
    247    491    542    764   1009   2466   3023   3148   3629   3682
   3723   3723   4391   4635   5846   6694   6996   7613   7651   8020
   8122   9522  10013  10082  10181  10384  10871  11273  11425  11510
  12288  12755  12911  13107  13914  14119  16457  17134  17370  17641
  18780  19093  19972  20143  20514  20527  20710  21318  21773  22890
  23453  23574  24060  24575  25306  25422  26172  27694  27965  28121
  29050  31265  31451  31647  32717  32956  33396  34126  35005  35102
  35923  36459  36476  37535  38482  39236  40205  40273  40519  40538
  40607  41107  41255  41372  41394  41669  41984  42057  42197  42239
  42450  42660  42844  42873  44369  44713  45251  45606  45721  45825
  46107  46655  47613  47643  48240  48358  48413  48439  49232  50159
  50287  50570  50573  51240  51334  51376  51415  51498  51617  51633
  52785  53495  53579  53813  54310  55538  55814  55931  57821  58445
  59186  59454  60559  62277  63458  64010  64152  64224  64602  64753], scale=4.86428394824976e-06, z=0
dequantizedVec=[-0.313 -0.308 -0.306 -0.306 -0.302 -0.3   -0.297 -0.297 -0.296 -0.292
 -0.291 -0.29  -0.287 -0.287 -0.286 -0.285 -0.285 -0.284 -0.279 -0.278
 -0.278 -0.277 -0.275 -0.274 -0.274 -0.274 -0.272 -0.272 -0.27  -0.264
 -0.261 -0.26  -0.253 -0.25  -0.249 -0.249 -0.246 -0.246 -0.245 -0.245
 -0.243 -0.242 -0.241 -0.24  -0.24  -0.234 -0.231 -0.23  -0.23  -0.226
 -0.224 -0.219 -0.218 -0.216 -0.212 -0.21  -0.21  -0.206 -0.206 -0.204
 -0.203 -0.2   -0.196 -0.195 -0.194 -0.194 -0.194 -0.187 -0.185 -0.182
 -0.181 -0.178 -0.178 -0.177 -0.176 -0.175 -0.171 -0.164 -0.164 -0.161
 -0.16  -0.159 -0.159 -0.154 -0.149 -0.149 -0.149 -0.146 -0.144 -0.142
 -0.141 -0.141 -0.137 -0.136 -0.135 -0.135 -0.132 -0.124 -0.123 -0.123
 -0.121 -0.121 -0.119 -0.119 -0.117 -0.115 -0.114 -0.109 -0.106 -0.103
 -0.102 -0.101 -0.1   -0.098 -0.096 -0.093 -0.091 -0.09  -0.089 -0.088
 -0.088 -0.088 -0.084 -0.084 -0.081 -0.081 -0.08  -0.078 -0.078 -0.074
 -0.072 -0.072 -0.071 -0.067 -0.066 -0.065 -0.064 -0.063 -0.062 -0.054
 -0.053 -0.052 -0.046 -0.045 -0.045 -0.043 -0.041 -0.038 -0.03  -0.029
 -0.025 -0.023 -0.019 -0.019 -0.018 -0.013 -0.01  -0.01  -0.008 -0.007
  0.001  0.002  0.003  0.004  0.005  0.012  0.015  0.015  0.018  0.018
  0.018  0.018  0.021  0.023  0.028  0.033  0.034  0.037  0.037  0.039
  0.04   0.046  0.049  0.049  0.05   0.051  0.053  0.055  0.056  0.056
  0.06   0.062  0.063  0.064  0.068  0.069  0.08   0.083  0.084  0.086
  0.091  0.093  0.097  0.098  0.1    0.1    0.101  0.104  0.106  0.111
  0.114  0.115  0.117  0.12   0.123  0.124  0.127  0.135  0.136  0.137
  0.141  0.152  0.153  0.154  0.159  0.16   0.162  0.166  0.17   0.171
  0.175  0.177  0.177  0.183  0.187  0.191  0.196  0.196  0.197  0.197
  0.198  0.2    0.201  0.201  0.201  0.203  0.204  0.205  0.205  0.205
  0.206  0.208  0.208  0.209  0.216  0.217  0.22   0.222  0.222  0.223
  0.224  0.227  0.232  0.232  0.235  0.235  0.235  0.236  0.239  0.244
  0.245  0.246  0.246  0.249  0.25   0.25   0.25   0.251  0.251  0.251
  0.257  0.26   0.261  0.262  0.264  0.27   0.271  0.272  0.281  0.284
  0.288  0.289  0.295  0.303  0.309  0.311  0.312  0.312  0.314  0.315]
-------------------------------------------------------------------
Quantization Grid - Max: 64512, Min: -64512
Quantized Weights:
[-64512. -63488. -62464. -62464. -61440. -61440. -60416. -60416. -60416.
 -59392. -59392. -59392. -58368. -58368. -58368. -58368. -58368. -58368.
 -57344. -57344. -57344. -56320. -56320. -56320. -56320. -56320. -55296.
 -55296. -55296. -54272. -53248. -53248. -52224. -51200. -51200. -51200.
 -50176. -50176. -50176. -50176. -50176. -49152. -49152. -49152. -49152.
 -48128. -47104. -47104. -47104. -46080. -46080. -45056. -45056. -44032.
 -43008. -43008. -43008. -41984. -41984. -41984. -41984. -40960. -39936.
 -39936. -39936. -39936. -39936. -37888. -37888. -36864. -36864. -36864.
 -36864. -35840. -35840. -35840. -34816. -33792. -33792. -32768. -32768.
 -32768. -32768. -31744. -30720. -30720. -30720. -29696. -29696. -28672.
 -28672. -28672. -27648. -27648. -27648. -27648. -26624. -25600. -25600.
 -25600. -24576. -24576. -24576. -24576. -23552. -23552. -23552. -22528.
 -21504. -21504. -20480. -20480. -20480. -20480. -19456. -19456. -18432.
 -18432. -18432. -18432. -18432. -18432. -17408. -17408. -16384. -16384.
 -16384. -15872. -15872. -15360. -14848. -14848. -14336. -13824. -13824.
 -13312. -12800. -12800. -12800. -11264. -10752. -10752.  -9216.  -9216.
  -9216.  -8704.  -8192.  -7680.  -6144.  -5632.  -5120.  -4608.  -4096.
  -3840.  -3840.  -2560.  -2048.  -2048.  -1664.  -1408.    256.    512.
    512.    768.   1024.   2560.   3072.   3072.   3584.   3584.   3584.
   3584.   4608.   4608.   5632.   6656.   7168.   7680.   7680.   8192.
   8192.   9728.   9728.  10240.  10240.  10240.  10752.  11264.  11264.
  11264.  12288.  12800.  12800.  13312.  13824.  13824.  16384.  17408.
  17408.  17408.  18432.  19456.  19456.  20480.  20480.  20480.  20480.
  21504.  21504.  22528.  23552.  23552.  23552.  24576.  25600.  25600.
  25600.  27648.  27648.  27648.  28672.  30720.  31744.  31744.  32768.
  32768.  32768.  33792.  34816.  34816.  35840.  35840.  35840.  37888.
  37888.  38912.  39936.  39936.  39936.  39936.  40960.  40960.  40960.
  40960.  40960.  41984.  41984.  41984.  41984.  41984.  41984.  43008.
  43008.  43008.  44032.  45056.  45056.  45056.  45056.  46080.  46080.
  46080.  47104.  47104.  48128.  48128.  48128.  48128.  49152.  50176.
  50176.  50176.  50176.  51200.  51200.  51200.  51200.  51200.  51200.
  51200.  52224.  53248.  53248.  53248.  54272.  55296.  55296.  55296.
  57344.  58368.  59392.  59392.  60416.  62464.  63488.  63488.  63488.
  63488.  64512.  64512.]
Original Output: [-5.590e+02 -5.050e+02 -4.269e+02 -3.969e+02 -3.578e+02 -2.746e+02
 -2.496e+02 -1.441e+02 -1.358e+02 -1.273e+02 -1.038e+02 -9.602e+01
 -6.509e+01 -6.159e+01 -4.063e+01 -1.770e+01  4.320e-01  3.349e+01
  4.950e+01  6.030e+01  6.216e+01  6.651e+01  1.003e+02  1.740e+02
  1.772e+02  2.456e+02  3.162e+02  3.353e+02  5.087e+02  5.385e+02]
Quantized Output: [-7.342e+09 -6.649e+09 -5.663e+09 -5.298e+09 -4.723e+09 -3.611e+09
 -3.275e+09 -1.908e+09 -1.794e+09 -1.665e+09 -1.403e+09 -1.267e+09
 -8.465e+08 -7.686e+08 -5.598e+08 -2.520e+08 -1.195e+07  4.287e+08
  6.611e+08  8.164e+08  8.655e+08  8.665e+08  1.327e+09  2.300e+09
  2.329e+09  3.231e+09  4.159e+09  4.427e+09  6.710e+09  7.128e+09]
Dequantized Output: [-555.664 -503.207 -428.57  -400.935 -357.485 -273.295 -247.881 -144.409
 -135.814 -125.993 -106.19   -95.875  -64.068  -58.169  -42.365  -19.074
   -0.905   32.449   50.037   61.787   65.507   65.578  100.45   174.076
  176.256  244.528  314.806  335.063  507.818  539.479]
🔹 Maximum difference: 4.076348879680552
🔹 Minimum difference: 0.0007498147840010461
🔹 Relative error (for each element): [3.094e+00 5.499e-02 6.819e-03 8.073e-04 9.926e-03 6.009e-03 3.897e-03
 5.584e-03 3.590e-03 2.347e-02 1.663e-03 4.269e-02 1.089e-02 5.558e-02
 1.868e-03 3.120e-02 5.521e-06 8.897e-04 4.442e-03 1.509e-02 1.871e-03
 2.909e-04 4.590e-03 1.247e-03 2.463e-02 7.741e-02 4.342e-03 1.576e-02
 1.027e-02 1.471e-03]
🔹 Mean relative error: 0.11717980953851642
🔹 Mean absolute error: 1.3479461981618959


