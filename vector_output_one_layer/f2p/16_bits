C:\Users\97253\AppData\Local\Programs\Python\Python311\python.exe "C:\Users\97253\OneDrive\×©×•×œ×—×Ÿ ×”×¢×‘×•×“×”\final project\Sketches-main\src\Quntize_one_layer_vector.py"
original x:tensor([ 6.5657e-01,  2.0000e+00,  1.0000e+03, -4.0000e+00, -5.0000e-01,
         6.1100e+00,  7.0000e+00,  8.0000e+00, -1.0000e+03,  4.5000e-01])
Original Weights:
[-3.147e-01 -3.125e-01 -3.122e-01 -3.116e-01 -3.104e-01 -3.103e-01
 -3.085e-01 -3.064e-01 -3.027e-01 -3.016e-01 -3.001e-01 -2.986e-01
 -2.982e-01 -2.968e-01 -2.956e-01 -2.947e-01 -2.902e-01 -2.842e-01
 -2.812e-01 -2.810e-01 -2.785e-01 -2.784e-01 -2.742e-01 -2.721e-01
 -2.700e-01 -2.689e-01 -2.683e-01 -2.672e-01 -2.654e-01 -2.651e-01
 -2.648e-01 -2.622e-01 -2.592e-01 -2.571e-01 -2.565e-01 -2.549e-01
 -2.520e-01 -2.513e-01 -2.499e-01 -2.460e-01 -2.444e-01 -2.423e-01
 -2.400e-01 -2.398e-01 -2.392e-01 -2.387e-01 -2.379e-01 -2.359e-01
 -2.358e-01 -2.341e-01 -2.294e-01 -2.291e-01 -2.253e-01 -2.229e-01
 -2.216e-01 -2.213e-01 -2.174e-01 -2.164e-01 -2.114e-01 -2.092e-01
 -1.992e-01 -1.963e-01 -1.948e-01 -1.932e-01 -1.925e-01 -1.924e-01
 -1.915e-01 -1.914e-01 -1.900e-01 -1.835e-01 -1.827e-01 -1.819e-01
 -1.817e-01 -1.809e-01 -1.778e-01 -1.755e-01 -1.739e-01 -1.729e-01
 -1.701e-01 -1.680e-01 -1.667e-01 -1.645e-01 -1.612e-01 -1.461e-01
 -1.444e-01 -1.413e-01 -1.393e-01 -1.392e-01 -1.386e-01 -1.385e-01
 -1.383e-01 -1.365e-01 -1.259e-01 -1.243e-01 -1.213e-01 -1.208e-01
 -1.197e-01 -1.180e-01 -1.171e-01 -1.156e-01 -1.112e-01 -1.045e-01
 -1.040e-01 -1.038e-01 -9.901e-02 -9.624e-02 -8.945e-02 -8.906e-02
 -8.688e-02 -8.546e-02 -7.482e-02 -6.931e-02 -6.778e-02 -6.775e-02
 -6.575e-02 -6.341e-02 -5.968e-02 -5.941e-02 -5.860e-02 -5.811e-02
 -5.124e-02 -5.000e-02 -4.992e-02 -4.935e-02 -4.760e-02 -4.018e-02
 -3.808e-02 -3.426e-02 -2.722e-02 -2.467e-02 -2.167e-02 -2.089e-02
 -2.078e-02 -1.962e-02 -1.755e-02 -1.621e-02 -1.610e-02 -7.598e-03
 -4.031e-03 -3.980e-03 -4.579e-04  2.925e-04  1.429e-03  1.998e-03
  2.161e-03  5.838e-03  7.663e-03  1.152e-02  1.634e-02  1.687e-02
  1.994e-02  2.107e-02  2.237e-02  2.420e-02  2.825e-02  3.496e-02
  3.541e-02  3.862e-02  4.454e-02  4.900e-02  4.981e-02  5.047e-02
  5.082e-02  5.431e-02  5.667e-02  5.896e-02  5.914e-02  5.959e-02
  6.129e-02  6.281e-02  6.358e-02  6.645e-02  6.731e-02  6.783e-02
  6.795e-02  6.881e-02  7.176e-02  7.176e-02  7.190e-02  7.280e-02
  7.396e-02  7.685e-02  7.860e-02  7.995e-02  8.300e-02  8.327e-02
  8.430e-02  8.478e-02  8.876e-02  9.833e-02  9.921e-02  9.973e-02
  1.011e-01  1.023e-01  1.044e-01  1.046e-01  1.057e-01  1.079e-01
  1.104e-01  1.104e-01  1.107e-01  1.135e-01  1.147e-01  1.150e-01
  1.179e-01  1.183e-01  1.227e-01  1.254e-01  1.258e-01  1.262e-01
  1.265e-01  1.270e-01  1.283e-01  1.300e-01  1.327e-01  1.365e-01
  1.382e-01  1.411e-01  1.421e-01  1.427e-01  1.448e-01  1.493e-01
  1.514e-01  1.514e-01  1.521e-01  1.543e-01  1.615e-01  1.618e-01
  1.627e-01  1.639e-01  1.687e-01  1.691e-01  1.739e-01  1.751e-01
  1.759e-01  1.760e-01  1.818e-01  1.822e-01  1.863e-01  1.870e-01
  1.873e-01  1.927e-01  1.943e-01  1.945e-01  1.950e-01  1.970e-01
  1.974e-01  2.004e-01  2.015e-01  2.025e-01  2.045e-01  2.050e-01
  2.104e-01  2.114e-01  2.126e-01  2.174e-01  2.205e-01  2.207e-01
  2.220e-01  2.244e-01  2.268e-01  2.347e-01  2.359e-01  2.402e-01
  2.427e-01  2.432e-01  2.464e-01  2.511e-01  2.521e-01  2.533e-01
  2.539e-01  2.545e-01  2.547e-01  2.550e-01  2.569e-01  2.570e-01
  2.589e-01  2.603e-01  2.632e-01  2.637e-01  2.660e-01  2.741e-01
  2.753e-01  2.773e-01  2.838e-01  2.857e-01  2.871e-01  2.874e-01
  2.932e-01  2.942e-01  2.947e-01  2.984e-01  3.005e-01  3.052e-01
  3.064e-01  3.073e-01  3.078e-01  3.099e-01  3.120e-01  3.130e-01]
quantizedVec=[-16822066 -16704264 -16688345 -16658440 -16595488 -16586384 -16492926
 -16379444 -16180262 -16122529 -16045720 -15962017 -15938994 -15866962
 -15800869 -15754153 -15515051 -15191954 -15032887 -15021457 -14888693
 -14881469 -14660687 -14545552 -14432343 -14374095 -14343324 -14284883
 -14189381 -14173424 -14155146 -14015089 -13856140 -13745997 -13712812
 -13628403 -13473486 -13433891 -13359238 -13150031 -13064745 -12954494
 -12832330 -12821700 -12785852 -12761237 -12717671 -12613633 -12603534
 -12515803 -12265110 -12247697 -12047047 -11913789 -11844907 -11828442
 -11623378 -11569087 -11303692 -11183608 -10650940 -10493493 -10411448
 -10330143 -10290865 -10285789 -10239365 -10231953 -10156189  -9809104
  -9767070  -9722623  -9711175  -9669120  -9505845  -9380380  -9294189
  -9245391  -9094199  -8978547  -8912228  -8794268  -8615081  -7808186
  -7720278  -7551561  -7447271  -7440170  -7407661  -7406656  -7394354
  -7296160  -6731691  -6642523  -6484745  -6459691  -6398343  -6307680
  -6260671  -6182190  -5944981  -5587476  -5560395  -5548781  -5293261
  -5145052  -4781837  -4760967  -4644496  -4568734  -3999831  -3705426
  -3623568  -3621889  -3515009  -3389886  -3190311  -3175954  -3132609
  -3106605  -2739132  -2672961  -2668674  -2638167  -2544569  -2148178
  -2035796  -1831497  -1455070  -1318594  -1158462  -1116835  -1110919
  -1049053   -938033   -866433   -860850   -406189   -215508   -212794
    -24481     15635     76378    106802    115512    312114    409638
    615715    873739    901697   1066137   1126590   1195930   1293729
   1510216   1868808   1892992   2064702   2381196   2619378   2662852
   2698083   2716630   2903542   3029428   3151823   3161394   3185469
   3276280   3357932   3398980   3552256   3598152   3626118   3632613
   3678300   3836020   3836136   3843696   3891628   3954012   4108136
   4201826   4274126   4437114   4451478   4506543   4532439   4745269
   5256772   5303781   5331487   5406948   5467061   5581610   5589568
   5651469   5770866   5900389   5900777   5915818   6067570   6129884
   6148452   6304718   6323107   6560275   6704496   6725013   6747333
   6763735   6791874   6860949   6951512   7092365   7299344   7388884
   7540442   7598000   7631282   7742180   7983238   8094591   8094755
   8132538   8249134   8635819   8649959   8698708   8760439   9016986
   9040447   9294767   9361301   9400864   9407904   9719173   9742914
   9961791   9996711  10011642  10301722  10388947  10398066  10424733
  10533540  10552965  10713019  10774259  10827851  10930798  10957577
  11247261  11299725  11367889  11619779  11788096  11800825  11866539
  11995873  12123473  12545445  12610875  12839259  12976485  13003238
  13174423  13425691  13476652  13541145  13572439  13604485  13613438
  13632133  13734580  13737285  13839958  13917280  14071378  14095267
  14221892  14653356  14717120  14826166  15170376  15274642  15346617
  15361689  15672451  15726082  15757019  15953701  16064588  16317300
  16380248  16430336  16453769  16566342  16680686  16730318], scale=1.8705813301613367e-08, z=0
dequantizedVec=[-3.147e-01 -3.125e-01 -3.122e-01 -3.116e-01 -3.104e-01 -3.103e-01
 -3.085e-01 -3.064e-01 -3.027e-01 -3.016e-01 -3.001e-01 -2.986e-01
 -2.982e-01 -2.968e-01 -2.956e-01 -2.947e-01 -2.902e-01 -2.842e-01
 -2.812e-01 -2.810e-01 -2.785e-01 -2.784e-01 -2.742e-01 -2.721e-01
 -2.700e-01 -2.689e-01 -2.683e-01 -2.672e-01 -2.654e-01 -2.651e-01
 -2.648e-01 -2.622e-01 -2.592e-01 -2.571e-01 -2.565e-01 -2.549e-01
 -2.520e-01 -2.513e-01 -2.499e-01 -2.460e-01 -2.444e-01 -2.423e-01
 -2.400e-01 -2.398e-01 -2.392e-01 -2.387e-01 -2.379e-01 -2.359e-01
 -2.358e-01 -2.341e-01 -2.294e-01 -2.291e-01 -2.253e-01 -2.229e-01
 -2.216e-01 -2.213e-01 -2.174e-01 -2.164e-01 -2.114e-01 -2.092e-01
 -1.992e-01 -1.963e-01 -1.948e-01 -1.932e-01 -1.925e-01 -1.924e-01
 -1.915e-01 -1.914e-01 -1.900e-01 -1.835e-01 -1.827e-01 -1.819e-01
 -1.817e-01 -1.809e-01 -1.778e-01 -1.755e-01 -1.739e-01 -1.729e-01
 -1.701e-01 -1.680e-01 -1.667e-01 -1.645e-01 -1.612e-01 -1.461e-01
 -1.444e-01 -1.413e-01 -1.393e-01 -1.392e-01 -1.386e-01 -1.385e-01
 -1.383e-01 -1.365e-01 -1.259e-01 -1.243e-01 -1.213e-01 -1.208e-01
 -1.197e-01 -1.180e-01 -1.171e-01 -1.156e-01 -1.112e-01 -1.045e-01
 -1.040e-01 -1.038e-01 -9.901e-02 -9.624e-02 -8.945e-02 -8.906e-02
 -8.688e-02 -8.546e-02 -7.482e-02 -6.931e-02 -6.778e-02 -6.775e-02
 -6.575e-02 -6.341e-02 -5.968e-02 -5.941e-02 -5.860e-02 -5.811e-02
 -5.124e-02 -5.000e-02 -4.992e-02 -4.935e-02 -4.760e-02 -4.018e-02
 -3.808e-02 -3.426e-02 -2.722e-02 -2.467e-02 -2.167e-02 -2.089e-02
 -2.078e-02 -1.962e-02 -1.755e-02 -1.621e-02 -1.610e-02 -7.598e-03
 -4.031e-03 -3.980e-03 -4.579e-04  2.925e-04  1.429e-03  1.998e-03
  2.161e-03  5.838e-03  7.663e-03  1.152e-02  1.634e-02  1.687e-02
  1.994e-02  2.107e-02  2.237e-02  2.420e-02  2.825e-02  3.496e-02
  3.541e-02  3.862e-02  4.454e-02  4.900e-02  4.981e-02  5.047e-02
  5.082e-02  5.431e-02  5.667e-02  5.896e-02  5.914e-02  5.959e-02
  6.129e-02  6.281e-02  6.358e-02  6.645e-02  6.731e-02  6.783e-02
  6.795e-02  6.881e-02  7.176e-02  7.176e-02  7.190e-02  7.280e-02
  7.396e-02  7.685e-02  7.860e-02  7.995e-02  8.300e-02  8.327e-02
  8.430e-02  8.478e-02  8.876e-02  9.833e-02  9.921e-02  9.973e-02
  1.011e-01  1.023e-01  1.044e-01  1.046e-01  1.057e-01  1.079e-01
  1.104e-01  1.104e-01  1.107e-01  1.135e-01  1.147e-01  1.150e-01
  1.179e-01  1.183e-01  1.227e-01  1.254e-01  1.258e-01  1.262e-01
  1.265e-01  1.270e-01  1.283e-01  1.300e-01  1.327e-01  1.365e-01
  1.382e-01  1.411e-01  1.421e-01  1.427e-01  1.448e-01  1.493e-01
  1.514e-01  1.514e-01  1.521e-01  1.543e-01  1.615e-01  1.618e-01
  1.627e-01  1.639e-01  1.687e-01  1.691e-01  1.739e-01  1.751e-01
  1.759e-01  1.760e-01  1.818e-01  1.822e-01  1.863e-01  1.870e-01
  1.873e-01  1.927e-01  1.943e-01  1.945e-01  1.950e-01  1.970e-01
  1.974e-01  2.004e-01  2.015e-01  2.025e-01  2.045e-01  2.050e-01
  2.104e-01  2.114e-01  2.126e-01  2.174e-01  2.205e-01  2.207e-01
  2.220e-01  2.244e-01  2.268e-01  2.347e-01  2.359e-01  2.402e-01
  2.427e-01  2.432e-01  2.464e-01  2.511e-01  2.521e-01  2.533e-01
  2.539e-01  2.545e-01  2.547e-01  2.550e-01  2.569e-01  2.570e-01
  2.589e-01  2.603e-01  2.632e-01  2.637e-01  2.660e-01  2.741e-01
  2.753e-01  2.773e-01  2.838e-01  2.857e-01  2.871e-01  2.874e-01
  2.932e-01  2.942e-01  2.947e-01  2.984e-01  3.005e-01  3.052e-01
  3.064e-01  3.073e-01  3.078e-01  3.099e-01  3.120e-01  3.130e-01]
-------------------------------------------------------------------
Quantization Grid - Max: 16776192, Min: -16776192
Quantized Weights:
[-1.678e+07 -1.666e+07 -1.664e+07 -1.661e+07 -1.655e+07 -1.654e+07
 -1.645e+07 -1.633e+07 -1.614e+07 -1.608e+07 -1.600e+07 -1.592e+07
 -1.590e+07 -1.582e+07 -1.576e+07 -1.571e+07 -1.547e+07 -1.515e+07
 -1.499e+07 -1.498e+07 -1.485e+07 -1.484e+07 -1.462e+07 -1.451e+07
 -1.439e+07 -1.433e+07 -1.430e+07 -1.425e+07 -1.415e+07 -1.413e+07
 -1.412e+07 -1.398e+07 -1.382e+07 -1.371e+07 -1.368e+07 -1.359e+07
 -1.344e+07 -1.340e+07 -1.332e+07 -1.311e+07 -1.303e+07 -1.292e+07
 -1.280e+07 -1.279e+07 -1.275e+07 -1.273e+07 -1.268e+07 -1.258e+07
 -1.257e+07 -1.248e+07 -1.223e+07 -1.221e+07 -1.201e+07 -1.188e+07
 -1.181e+07 -1.180e+07 -1.159e+07 -1.154e+07 -1.127e+07 -1.115e+07
 -1.062e+07 -1.047e+07 -1.038e+07 -1.030e+07 -1.026e+07 -1.026e+07
 -1.021e+07 -1.020e+07 -1.013e+07 -9.782e+06 -9.740e+06 -9.696e+06
 -9.685e+06 -9.643e+06 -9.480e+06 -9.355e+06 -9.269e+06 -9.220e+06
 -9.070e+06 -8.954e+06 -8.888e+06 -8.771e+06 -8.591e+06 -7.786e+06
 -7.699e+06 -7.530e+06 -7.427e+06 -7.420e+06 -7.387e+06 -7.386e+06
 -7.374e+06 -7.277e+06 -6.713e+06 -6.624e+06 -6.467e+06 -6.442e+06
 -6.381e+06 -6.290e+06 -6.243e+06 -6.166e+06 -5.929e+06 -5.573e+06
 -5.545e+06 -5.534e+06 -5.279e+06 -5.131e+06 -4.769e+06 -4.748e+06
 -4.632e+06 -4.556e+06 -3.989e+06 -3.695e+06 -3.614e+06 -3.612e+06
 -3.506e+06 -3.381e+06 -3.182e+06 -3.167e+06 -3.124e+06 -3.098e+06
 -2.732e+06 -2.665e+06 -2.661e+06 -2.631e+06 -2.537e+06 -2.142e+06
 -2.030e+06 -1.826e+06 -1.451e+06 -1.315e+06 -1.155e+06 -1.114e+06
 -1.108e+06 -1.046e+06 -9.354e+05 -8.640e+05 -8.586e+05 -4.051e+05
 -2.149e+05 -2.122e+05 -2.442e+04  1.559e+04  7.616e+04  1.065e+05
  1.152e+05  3.113e+05  4.086e+05  6.141e+05  8.714e+05  8.993e+05
  1.063e+06  1.123e+06  1.192e+06  1.290e+06  1.506e+06  1.864e+06
  1.888e+06  2.059e+06  2.375e+06  2.612e+06  2.656e+06  2.691e+06
  2.709e+06  2.896e+06  3.021e+06  3.143e+06  3.153e+06  3.177e+06
  3.268e+06  3.349e+06  3.390e+06  3.543e+06  3.588e+06  3.616e+06
  3.623e+06  3.668e+06  3.826e+06  3.826e+06  3.833e+06  3.881e+06
  3.943e+06  4.097e+06  4.190e+06  4.263e+06  4.425e+06  4.439e+06
  4.494e+06  4.520e+06  4.732e+06  5.243e+06  5.289e+06  5.317e+06
  5.392e+06  5.452e+06  5.566e+06  5.575e+06  5.636e+06  5.755e+06
  5.884e+06  5.885e+06  5.899e+06  6.051e+06  6.113e+06  6.132e+06
  6.287e+06  6.306e+06  6.542e+06  6.687e+06  6.706e+06  6.729e+06
  6.745e+06  6.774e+06  6.842e+06  6.932e+06  7.073e+06  7.280e+06
  7.369e+06  7.520e+06  7.578e+06  7.610e+06  7.721e+06  7.962e+06
  8.072e+06  8.072e+06  8.110e+06  8.227e+06  8.612e+06  8.626e+06
  8.675e+06  8.737e+06  8.993e+06  9.015e+06  9.269e+06  9.336e+06
  9.375e+06  9.382e+06  9.692e+06  9.717e+06  9.935e+06  9.970e+06
  9.984e+06  1.027e+07  1.036e+07  1.037e+07  1.040e+07  1.051e+07
  1.052e+07  1.068e+07  1.074e+07  1.080e+07  1.090e+07  1.093e+07
  1.122e+07  1.127e+07  1.134e+07  1.159e+07  1.176e+07  1.177e+07
  1.183e+07  1.196e+07  1.209e+07  1.251e+07  1.258e+07  1.280e+07
  1.294e+07  1.297e+07  1.314e+07  1.339e+07  1.344e+07  1.350e+07
  1.354e+07  1.357e+07  1.358e+07  1.359e+07  1.370e+07  1.370e+07
  1.380e+07  1.388e+07  1.403e+07  1.406e+07  1.418e+07  1.461e+07
  1.468e+07  1.479e+07  1.513e+07  1.523e+07  1.530e+07  1.532e+07
  1.563e+07  1.568e+07  1.571e+07  1.591e+07  1.602e+07  1.627e+07
  1.634e+07  1.639e+07  1.641e+07  1.652e+07  1.663e+07  1.669e+07]
Original Output: [-534.031 -518.73  -431.651 -261.219 -237.717 -182.588 -142.812  -85.905
  -31.97   -21.876    6.727    7.593   16.954   74.668   83.628  100.864
  131.835  140.773  222.95   227.854  245.386  307.703  315.601  337.636
  337.961  430.441  433.624  438.475  478.09   482.313]
Quantized Output: [-4.777e+14 -4.641e+14 -3.862e+14 -2.334e+14 -2.127e+14 -1.635e+14
 -1.280e+14 -7.705e+13 -2.848e+13 -1.939e+13  6.068e+12  6.838e+12
  1.511e+13  6.674e+13  7.467e+13  9.023e+13  1.180e+14  1.261e+14
  1.994e+14  2.041e+14  2.196e+14  2.752e+14  2.821e+14  3.021e+14
  3.025e+14  3.848e+14  3.877e+14  3.921e+14  4.279e+14  4.312e+14]
Dequantized Output: [-534.083 -518.941 -431.806 -260.997 -237.867 -182.835 -143.082  -86.144
  -31.846  -21.684    6.784    7.646   16.897   74.621   83.482  100.883
  131.982  140.971  222.927  228.163  245.506  307.661  315.411  337.782
  338.256  430.191  433.454  438.39   478.383  482.093]
ðŸ”¹ Maximum difference: 0.3096675221184455
ðŸ”¹ Minimum difference: 0.018859738200561083
ðŸ”¹ Relative error (for each element): [8.799e-03 1.405e-03 8.525e-04 6.953e-03 4.569e-04 1.351e-03 4.315e-04
 1.113e-03 6.023e-04 4.057e-04 9.719e-05 3.351e-03 6.331e-04 3.593e-04
 3.854e-03 1.375e-04 2.783e-03 4.905e-04 5.815e-04 1.033e-04 1.887e-03
 1.747e-03 3.919e-04 8.484e-03 1.941e-04 6.300e-04 8.733e-04 1.870e-04
 6.139e-04 1.359e-03]
ðŸ”¹ Mean relative error: 0.001704236665745952
ðŸ”¹ Mean absolute error: 0.15765281386645338


