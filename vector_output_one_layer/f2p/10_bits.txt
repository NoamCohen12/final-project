C:\Users\97253\AppData\Local\Programs\Python\Python311\python.exe "C:\Users\97253\OneDrive\×©×•×œ×—×Ÿ ×”×¢×‘×•×“×”\final project\Sketches-main\src\Quntize_one_layer_vector.py" 
original x:tensor([ 6.5657e-01,  2.0000e+00,  1.0000e+03, -4.0000e+00, -5.0000e-01,
         6.1100e+00,  7.0000e+00,  8.0000e+00, -1.0000e+03,  4.5000e-01])
Original Weights:
[-0.316 -0.312 -0.31  -0.306 -0.303 -0.3   -0.298 -0.298 -0.298 -0.297
 -0.292 -0.292 -0.289 -0.287 -0.284 -0.281 -0.281 -0.28  -0.273 -0.271
 -0.269 -0.262 -0.261 -0.256 -0.255 -0.254 -0.253 -0.25  -0.248 -0.247
 -0.245 -0.243 -0.243 -0.242 -0.242 -0.238 -0.238 -0.237 -0.233 -0.233
 -0.232 -0.229 -0.226 -0.222 -0.221 -0.22  -0.219 -0.219 -0.213 -0.212
 -0.207 -0.204 -0.202 -0.201 -0.2   -0.199 -0.196 -0.196 -0.195 -0.194
 -0.192 -0.192 -0.188 -0.183 -0.183 -0.18  -0.175 -0.175 -0.172 -0.17
 -0.167 -0.166 -0.163 -0.163 -0.162 -0.162 -0.158 -0.156 -0.156 -0.153
 -0.152 -0.152 -0.151 -0.151 -0.149 -0.145 -0.137 -0.137 -0.137 -0.129
 -0.116 -0.114 -0.111 -0.109 -0.108 -0.108 -0.106 -0.102 -0.1   -0.1
 -0.09  -0.084 -0.081 -0.081 -0.081 -0.079 -0.075 -0.071 -0.071 -0.071
 -0.068 -0.066 -0.064 -0.063 -0.06  -0.043 -0.043 -0.039 -0.037 -0.032
 -0.024 -0.022 -0.021 -0.021 -0.02  -0.018 -0.013 -0.013 -0.007 -0.005
  0.001  0.001  0.004  0.005  0.006  0.007  0.008  0.01   0.013  0.014
  0.015  0.016  0.016  0.016  0.017  0.019  0.021  0.022  0.024  0.024
  0.025  0.027  0.029  0.03   0.031  0.033  0.035  0.035  0.04   0.041
  0.041  0.043  0.044  0.044  0.045  0.045  0.045  0.05   0.05   0.053
  0.054  0.054  0.056  0.056  0.064  0.068  0.068  0.069  0.073  0.073
  0.074  0.074  0.081  0.082  0.084  0.09   0.095  0.099  0.101  0.102
  0.103  0.107  0.108  0.108  0.109  0.112  0.115  0.115  0.117  0.118
  0.12   0.12   0.122  0.123  0.123  0.123  0.126  0.126  0.126  0.129
  0.134  0.137  0.139  0.139  0.145  0.148  0.149  0.15   0.151  0.153
  0.153  0.154  0.158  0.159  0.159  0.16   0.16   0.165  0.165  0.168
  0.171  0.172  0.184  0.186  0.187  0.193  0.195  0.197  0.199  0.202
  0.202  0.203  0.207  0.209  0.21   0.211  0.213  0.214  0.216  0.221
  0.222  0.222  0.227  0.229  0.23   0.233  0.237  0.237  0.238  0.24
  0.24   0.245  0.247  0.25   0.251  0.253  0.255  0.256  0.258  0.263
  0.263  0.264  0.264  0.266  0.266  0.269  0.269  0.269  0.271  0.274
  0.275  0.281  0.283  0.285  0.287  0.292  0.293  0.294  0.294  0.296
  0.299  0.304  0.306  0.308  0.308  0.31   0.311  0.312  0.316  0.316]
quantizedVec=[-261167 -257465 -256374 -252938 -250605 -248053 -246540 -246333 -245789
 -244989 -241634 -241574 -238480 -236747 -234835 -231953 -231792 -231200
 -225588 -223538 -222234 -216537 -215843 -211625 -211067 -209485 -209407
 -206801 -204569 -203658 -202624 -200736 -200356 -200319 -200200 -196860
 -196243 -195927 -192717 -192097 -191524 -189002 -187070 -183309 -182878
 -181935 -180912 -180725 -176080 -175262 -170779 -168317 -166848 -166406
 -165301 -164522 -161931 -161881 -160978 -160095 -158625 -158274 -155044
 -151188 -151152 -148449 -144190 -144159 -141951 -140519 -137971 -137278
 -135030 -134603 -133647 -133470 -130215 -129226 -129006 -126547 -125658
 -125461 -125090 -124334 -122755 -120083 -113470 -113300 -112769 -106750
  -96191  -94535  -91382  -89813  -89612  -89435  -87668  -84216  -82841
  -82518  -74183  -69741  -66837  -66734  -66548  -65116  -62352  -58792
  -58467  -58396  -55788  -54132  -52856  -51974  -49978  -35885  -35158
  -32174  -30953  -26222  -19667  -18413  -17343  -17236  -16609  -14786
  -11146  -10427   -5378   -4139    1100    1121    2916    4253    5341
    6066    6358    8016   10666   11177   12686   13323   13402   13584
   13632   15518   16942   17918   19844   20048   20730   22162   24276
   24508   25914   26877   29054   29150   33300   33981   34080   35755
   35993   36712   37429   37429   37489   40997   41356   43568   44617
   44681   45871   46541   52670   56348   56442   57353   59977   60062
   60795   61361   67118   67920   69438   74565   78413   82165   83173
   84664   84735   88235   88829   89268   90138   92873   94644   95058
   96417   97317   99420   99521  100456  101627  101826  101847  103804
  104189  104407  106833  110647  113216  114472  114971  120194  122544
  122807  123513  124749  126501  126570  127094  130811  131071  131292
  132148  132282  136566  136664  139080  141432  142245  152369  153911
  154779  159650  160744  162355  164662  166615  167057  168006  171168
  172414  173305  173960  175750  177117  178577  182367  183089  183530
  187780  188987  190249  192261  195717  196012  196538  198562  198603
  202383  203787  206508  207750  209139  210658  211575  213310  217358
  217466  217684  218018  220091  220135  221977  221982  222438  223868
  226155  227415  232354  234168  235790  237041  240977  242163  242580
  243260  244475  247278  251230  252756  254107  254765  256468  256940
  257349  260794  261072], scale=1.2104942773779234e-06, z=0
dequantizedVec=[-0.316 -0.312 -0.31  -0.306 -0.303 -0.3   -0.298 -0.298 -0.298 -0.297
 -0.292 -0.292 -0.289 -0.287 -0.284 -0.281 -0.281 -0.28  -0.273 -0.271
 -0.269 -0.262 -0.261 -0.256 -0.255 -0.254 -0.253 -0.25  -0.248 -0.247
 -0.245 -0.243 -0.243 -0.242 -0.242 -0.238 -0.238 -0.237 -0.233 -0.233
 -0.232 -0.229 -0.226 -0.222 -0.221 -0.22  -0.219 -0.219 -0.213 -0.212
 -0.207 -0.204 -0.202 -0.201 -0.2   -0.199 -0.196 -0.196 -0.195 -0.194
 -0.192 -0.192 -0.188 -0.183 -0.183 -0.18  -0.175 -0.175 -0.172 -0.17
 -0.167 -0.166 -0.163 -0.163 -0.162 -0.162 -0.158 -0.156 -0.156 -0.153
 -0.152 -0.152 -0.151 -0.151 -0.149 -0.145 -0.137 -0.137 -0.137 -0.129
 -0.116 -0.114 -0.111 -0.109 -0.108 -0.108 -0.106 -0.102 -0.1   -0.1
 -0.09  -0.084 -0.081 -0.081 -0.081 -0.079 -0.075 -0.071 -0.071 -0.071
 -0.068 -0.066 -0.064 -0.063 -0.06  -0.043 -0.043 -0.039 -0.037 -0.032
 -0.024 -0.022 -0.021 -0.021 -0.02  -0.018 -0.013 -0.013 -0.007 -0.005
  0.001  0.001  0.004  0.005  0.006  0.007  0.008  0.01   0.013  0.014
  0.015  0.016  0.016  0.016  0.017  0.019  0.021  0.022  0.024  0.024
  0.025  0.027  0.029  0.03   0.031  0.033  0.035  0.035  0.04   0.041
  0.041  0.043  0.044  0.044  0.045  0.045  0.045  0.05   0.05   0.053
  0.054  0.054  0.056  0.056  0.064  0.068  0.068  0.069  0.073  0.073
  0.074  0.074  0.081  0.082  0.084  0.09   0.095  0.099  0.101  0.102
  0.103  0.107  0.108  0.108  0.109  0.112  0.115  0.115  0.117  0.118
  0.12   0.12   0.122  0.123  0.123  0.123  0.126  0.126  0.126  0.129
  0.134  0.137  0.139  0.139  0.145  0.148  0.149  0.15   0.151  0.153
  0.153  0.154  0.158  0.159  0.159  0.16   0.16   0.165  0.165  0.168
  0.171  0.172  0.184  0.186  0.187  0.193  0.195  0.197  0.199  0.202
  0.202  0.203  0.207  0.209  0.21   0.211  0.213  0.214  0.216  0.221
  0.222  0.222  0.227  0.229  0.23   0.233  0.237  0.237  0.238  0.24
  0.24   0.245  0.247  0.25   0.251  0.253  0.255  0.256  0.258  0.263
  0.263  0.264  0.264  0.266  0.266  0.269  0.269  0.269  0.271  0.274
  0.275  0.281  0.283  0.285  0.287  0.292  0.293  0.294  0.294  0.296
  0.299  0.304  0.306  0.308  0.308  0.31   0.311  0.312  0.316  0.316]
-------------------------------------------------------------------
Quantization Grid - Max: 261120, Min: -261120
Quantized Weights:
[-261120. -257024. -256000. -252928. -250880. -247808. -246784. -246784.
 -245760. -244736. -241664. -241664. -238592. -236544. -234496. -231424.
 -231424. -231424. -225280. -223232. -222208. -216064. -216064. -211968.
 -210944. -209920. -208896. -206848. -204800. -203776. -202752. -200704.
 -200704. -200704. -199680. -196608. -196608. -195584. -192512. -192512.
 -191488. -189440. -187392. -183296. -183296. -182272. -181248. -180224.
 -176128. -175104. -171008. -167936. -166912. -165888. -164864. -164864.
 -161792. -161792. -160768. -159744. -158720. -158720. -154624. -151552.
 -151552. -148480. -144384. -144384. -142336. -140288. -138240. -137216.
 -135168. -134144. -133120. -133120. -130048. -129024. -129024. -126976.
 -125952. -124928. -124928. -123904. -122880. -119808. -113664. -113664.
 -112640. -106496.  -96256.  -94208.  -91136.  -90112.  -89088.  -89088.
  -88064.  -83968.  -82944.  -82944.  -73728.  -69632.  -66560.  -66560.
  -66560.  -65024.  -62464.  -58880.  -58368.  -58368.  -55808.  -54272.
  -52736.  -51712.  -50176.  -35840.  -35328.  -32256.  -30720.  -26112.
  -19456.  -18432.  -17408.  -17408.  -16384.  -14848.  -11264.  -10496.
   -5376.   -4096.    1088.    1152.    2944.    4224.    5376.    6016.
    6400.    8064.   10752.   11264.   12800.   13312.   13312.   13568.
   13568.   15616.   16896.   17920.   19968.   19968.   20480.   22016.
   24064.   24576.   26112.   26624.   29184.   29184.   33280.   33792.
   34304.   35840.   35840.   36864.   37376.   37376.   37376.   40960.
   41472.   43520.   44544.   44544.   46080.   46592.   52736.   56320.
   56320.   57344.   59904.   59904.   60928.   61440.   67584.   67584.
   69632.   74752.   78848.   81920.   82944.   84992.   84992.   88064.
   89088.   89088.   90112.   93184.   94208.   95232.   96256.   97280.
   99328.   99328.  100352.  101376.  101376.  101376.  103424.  104448.
  104448.  106496.  110592.  113664.  114688.  114688.  119808.  122880.
  122880.  123904.  124928.  126976.  126976.  126976.  131072.  131072.
  131072.  132096.  132096.  136192.  136192.  139264.  141312.  142336.
  152576.  153600.  154624.  159744.  160768.  162816.  164864.  166912.
  166912.  167936.  171008.  172032.  173056.  174080.  176128.  177152.
  178176.  182272.  183296.  183296.  187392.  189440.  190464.  192512.
  195584.  195584.  196608.  198656.  198656.  202752.  203776.  206848.
  207872.  208896.  210944.  211968.  212992.  217088.  217088.  218112.
  218112.  220160.  220160.  222208.  222208.  222208.  224256.  226304.
  227328.  232448.  234496.  235520.  236544.  240640.  241664.  242688.
  243712.  244736.  246784.  250880.  252928.  253952.  254976.  256000.
  257024.  257024.  261120.  261120.]
Original Output: [-497.828 -483.881 -471.073 -394.606 -371.846 -300.169 -263.867 -235.373
 -207.039 -199.619 -138.155 -118.537  -71.621  -43.306   17.578   68.656
   87.711  149.256  158.554  167.161  171.096  172.646  181.138  238.83
  263.671  274.627  294.543  314.942  339.34   514.477]
Quantized Output: [-1.073e+11 -1.041e+11 -1.014e+11 -8.518e+10 -8.025e+10 -6.460e+10
 -5.698e+10 -5.065e+10 -4.470e+10 -4.313e+10 -2.970e+10 -2.546e+10
 -1.538e+10 -9.412e+09  4.024e+09  1.482e+10  1.886e+10  3.218e+10
  3.431e+10  3.596e+10  3.686e+10  3.716e+10  3.899e+10  5.162e+10
  5.683e+10  5.939e+10  6.370e+10  6.788e+10  7.312e+10  1.110e+11]
Dequantized Output: [-497.701 -482.6   -470.217 -394.949 -372.069 -299.547 -264.194 -234.862
 -207.249 -199.959 -137.702 -118.061  -71.313  -43.639   18.658   68.695
   87.429  149.215  159.061  166.744  170.892  172.294  180.778  239.342
  263.481  275.367  295.356  314.721  339.03   514.724]
ðŸ”¹ Maximum difference: 1.2811952650186527
ðŸ”¹ Minimum difference: 0.03902611236981102
ðŸ”¹ Relative error (for each element): [0.002 0.003 0.002 0.001 0.001 0.003 0.004 0.    0.061 0.001 0.    0.003
 0.002 0.001 0.008 0.002 0.002 0.002 0.001 0.001 0.001 0.    0.003 0.002
 0.001 0.003 0.002 0.003 0.004 0.001]
ðŸ”¹ Mean relative error: 0.004018347580591812
ðŸ”¹ Mean absolute error: 0.42421682329876886

Process finished with exit code 0
