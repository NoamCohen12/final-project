C:\Users\97253\AppData\Local\Programs\Python\Python311\python.exe "C:\Users\97253\OneDrive\×©×•×œ×—×Ÿ ×”×¢×‘×•×“×”\final project\Sketches-main\src\Quntize_one_layer_vector.py"
original x:tensor([ 6.5657e-01,  2.0000e+00,  1.0000e+03, -4.0000e+00, -5.0000e-01,
         6.1100e+00,  7.0000e+00,  8.0000e+00, -1.0000e+03,  4.5000e-01])
Original Weights:
[-0.313 -0.312 -0.311 -0.309 -0.307 -0.304 -0.302 -0.302 -0.301 -0.3
 -0.3   -0.294 -0.294 -0.294 -0.292 -0.292 -0.283 -0.283 -0.283 -0.283
 -0.282 -0.28  -0.28  -0.278 -0.277 -0.276 -0.271 -0.269 -0.265 -0.262
 -0.252 -0.251 -0.251 -0.249 -0.249 -0.249 -0.248 -0.243 -0.242 -0.242
 -0.239 -0.238 -0.237 -0.236 -0.231 -0.229 -0.226 -0.223 -0.222 -0.221
 -0.22  -0.218 -0.215 -0.214 -0.214 -0.213 -0.212 -0.212 -0.21  -0.21
 -0.209 -0.206 -0.205 -0.201 -0.193 -0.189 -0.184 -0.182 -0.181 -0.176
 -0.176 -0.171 -0.171 -0.169 -0.169 -0.166 -0.165 -0.165 -0.165 -0.156
 -0.15  -0.146 -0.146 -0.145 -0.141 -0.14  -0.14  -0.134 -0.133 -0.131
 -0.131 -0.13  -0.13  -0.128 -0.126 -0.126 -0.125 -0.124 -0.124 -0.119
 -0.118 -0.117 -0.117 -0.117 -0.116 -0.114 -0.109 -0.108 -0.107 -0.106
 -0.106 -0.098 -0.095 -0.091 -0.091 -0.087 -0.083 -0.082 -0.08  -0.079
 -0.078 -0.076 -0.073 -0.072 -0.071 -0.07  -0.07  -0.066 -0.065 -0.063
 -0.061 -0.058 -0.052 -0.047 -0.045 -0.04  -0.04  -0.037 -0.036 -0.031
 -0.028 -0.028 -0.025 -0.025 -0.024 -0.023 -0.021 -0.018 -0.016 -0.015
 -0.014 -0.014 -0.012 -0.01  -0.008 -0.006 -0.005 -0.005 -0.004 -0.001
  0.002  0.003  0.006  0.007  0.01   0.012  0.013  0.016  0.018  0.019
  0.022  0.023  0.037  0.038  0.039  0.043  0.043  0.049  0.057  0.062
  0.063  0.064  0.067  0.067  0.07   0.072  0.074  0.077  0.078  0.079
  0.08   0.081  0.082  0.084  0.087  0.088  0.089  0.09   0.091  0.093
  0.095  0.097  0.097  0.099  0.101  0.101  0.109  0.111  0.112  0.112
  0.114  0.114  0.119  0.123  0.124  0.124  0.126  0.127  0.127  0.137
  0.142  0.144  0.147  0.147  0.149  0.149  0.151  0.152  0.156  0.157
  0.158  0.163  0.165  0.173  0.176  0.181  0.188  0.19   0.192  0.194
  0.194  0.196  0.196  0.199  0.199  0.208  0.208  0.217  0.217  0.221
  0.225  0.225  0.226  0.227  0.234  0.235  0.236  0.238  0.239  0.24
  0.242  0.244  0.244  0.245  0.248  0.248  0.252  0.252  0.255  0.256
  0.26   0.262  0.262  0.263  0.267  0.269  0.272  0.272  0.277  0.28
  0.282  0.283  0.284  0.286  0.288  0.291  0.291  0.293  0.294  0.295
  0.297  0.297  0.3    0.303  0.305  0.308  0.309  0.311  0.314  0.315]
quantizedVec=[-126 -126 -125 -124 -124 -122 -122 -122 -121 -121 -121 -118 -118 -118
 -118 -118 -114 -114 -114 -114 -113 -113 -113 -112 -112 -111 -109 -108
 -107 -106 -102 -101 -101 -100 -100 -100 -100  -98  -97  -97  -96  -96
  -95  -95  -93  -92  -91  -90  -89  -89  -89  -88  -87  -86  -86  -86
  -85  -85  -84  -84  -84  -83  -82  -81  -78  -76  -74  -73  -73  -71
  -71  -69  -69  -68  -68  -67  -66  -66  -66  -63  -60  -58  -58  -58
  -56  -56  -56  -54  -53  -53  -52  -52  -52  -51  -51  -51  -50  -50
  -50  -48  -47  -47  -47  -47  -47  -45  -44  -43  -43  -42  -42  -39
  -38  -36  -36  -35  -33  -33  -32  -32  -31  -30  -29  -28  -28  -28
  -28  -26  -26  -25  -24  -23  -20  -19  -18  -16  -15  -14  -14  -12
  -11  -11  -10   -9   -9   -9   -8   -7   -6   -6   -5   -5   -4   -4
   -3   -2   -2   -1   -1    0    0    1    2    2    4    5    5    6
    7    7    8    9   15   15   15   17   17   19   23   25   25   25
   26   26   28   29   29   30   31   31   32   32   33   33   35   35
   36   36   36   37   38   39   39   40   40   40   44   44   45   45
   45   46   48   49   49   50   50   51   51   55   57   58   59   59
   60   60   60   61   62   63   63   66   66   69   71   73   76   76
   77   78   78   79   79   80   80   83   84   87   87   89   90   90
   91   91   94   94   95   96   96   97   97   98   98   98  100  100
  101  101  103  103  105  105  105  106  107  108  110  110  112  113
  114  114  114  115  116  117  117  118  118  119  120  120  121  122
  123  124  124  125  127  127], scale=0.002473006802281057, z=0
dequantizedVec=[-0.312 -0.312 -0.309 -0.307 -0.307 -0.302 -0.302 -0.302 -0.299 -0.299
 -0.299 -0.292 -0.292 -0.292 -0.292 -0.292 -0.282 -0.282 -0.282 -0.282
 -0.279 -0.279 -0.279 -0.277 -0.277 -0.275 -0.27  -0.267 -0.265 -0.262
 -0.252 -0.25  -0.25  -0.247 -0.247 -0.247 -0.247 -0.242 -0.24  -0.24
 -0.237 -0.237 -0.235 -0.235 -0.23  -0.228 -0.225 -0.223 -0.22  -0.22
 -0.22  -0.218 -0.215 -0.213 -0.213 -0.213 -0.21  -0.21  -0.208 -0.208
 -0.208 -0.205 -0.203 -0.2   -0.193 -0.188 -0.183 -0.181 -0.181 -0.176
 -0.176 -0.171 -0.171 -0.168 -0.168 -0.166 -0.163 -0.163 -0.163 -0.156
 -0.148 -0.143 -0.143 -0.143 -0.138 -0.138 -0.138 -0.134 -0.131 -0.131
 -0.129 -0.129 -0.129 -0.126 -0.126 -0.126 -0.124 -0.124 -0.124 -0.119
 -0.116 -0.116 -0.116 -0.116 -0.116 -0.111 -0.109 -0.106 -0.106 -0.104
 -0.104 -0.096 -0.094 -0.089 -0.089 -0.087 -0.082 -0.082 -0.079 -0.079
 -0.077 -0.074 -0.072 -0.069 -0.069 -0.069 -0.069 -0.064 -0.064 -0.062
 -0.059 -0.057 -0.049 -0.047 -0.045 -0.04  -0.037 -0.035 -0.035 -0.03
 -0.027 -0.027 -0.025 -0.022 -0.022 -0.022 -0.02  -0.017 -0.015 -0.015
 -0.012 -0.012 -0.01  -0.01  -0.007 -0.005 -0.005 -0.002 -0.002  0.
  0.     0.002  0.005  0.005  0.01   0.012  0.012  0.015  0.017  0.017
  0.02   0.022  0.037  0.037  0.037  0.042  0.042  0.047  0.057  0.062
  0.062  0.062  0.064  0.064  0.069  0.072  0.072  0.074  0.077  0.077
  0.079  0.079  0.082  0.082  0.087  0.087  0.089  0.089  0.089  0.092
  0.094  0.096  0.096  0.099  0.099  0.099  0.109  0.109  0.111  0.111
  0.111  0.114  0.119  0.121  0.121  0.124  0.124  0.126  0.126  0.136
  0.141  0.143  0.146  0.146  0.148  0.148  0.148  0.151  0.153  0.156
  0.156  0.163  0.163  0.171  0.176  0.181  0.188  0.188  0.19   0.193
  0.193  0.195  0.195  0.198  0.198  0.205  0.208  0.215  0.215  0.22
  0.223  0.223  0.225  0.225  0.232  0.232  0.235  0.237  0.237  0.24
  0.24   0.242  0.242  0.242  0.247  0.247  0.25   0.25   0.255  0.255
  0.26   0.26   0.26   0.262  0.265  0.267  0.272  0.272  0.277  0.279
  0.282  0.282  0.282  0.284  0.287  0.289  0.289  0.292  0.292  0.294
  0.297  0.297  0.299  0.302  0.304  0.307  0.307  0.309  0.314  0.314]
-------------------------------------------------------------------
Quantization Grid - Max: 127, Min: -127
Quantized Weights:
[-126. -126. -125. -124. -124. -122. -122. -121. -121. -121. -121. -118.
 -118. -118. -118. -118. -114. -114. -114. -114. -113. -113. -113. -112.
 -112. -111. -109. -108. -107. -106. -102. -101. -101. -100. -100. -100.
 -100.  -98.  -97.  -97.  -96.  -96.  -95.  -95.  -93.  -92.  -91.  -90.
  -89.  -89.  -89.  -88.  -87.  -86.  -86.  -86.  -85.  -85.  -84.  -84.
  -84.  -83.  -83.  -81.  -78.  -76.  -74.  -73.  -73.  -71.  -71.  -69.
  -69.  -68.  -68.  -67.  -67.  -66.  -66.  -63.  -60.  -59.  -59.  -58.
  -57.  -56.  -56.  -54.  -53.  -53.  -53.  -52.  -52.  -51.  -51.  -51.
  -50.  -50.  -50.  -48.  -47.  -47.  -47.  -47.  -47.  -46.  -44.  -43.
  -43.  -43.  -43.  -39.  -38.  -37.  -37.  -35.  -33.  -33.  -32.  -32.
  -31.  -31.  -30.  -29.  -29.  -28.  -28.  -27.  -26.  -25.  -24.  -24.
  -21.  -19.  -18.  -16.  -16.  -15.  -15.  -13.  -11.  -11.  -10.  -10.
  -10.   -9.   -8.   -7.   -6.   -6.   -6.   -6.   -5.   -4.   -3.   -2.
   -2.   -2.   -2.    0.    1.    1.    2.    3.    4.    5.    5.    6.
    7.    8.    9.    9.   15.   15.   16.   17.   17.   20.   23.   25.
   25.   26.   27.   27.   28.   29.   30.   31.   31.   32.   32.   32.
   33.   34.   35.   35.   36.   36.   37.   37.   38.   39.   39.   40.
   41.   41.   44.   45.   45.   45.   46.   46.   48.   49.   50.   50.
   51.   51.   51.   55.   57.   58.   59.   59.   60.   60.   61.   61.
   63.   63.   64.   66.   66.   69.   71.   73.   76.   76.   77.   78.
   78.   79.   79.   80.   80.   84.   84.   87.   88.   89.   90.   91.
   91.   91.   94.   95.   95.   96.   96.   97.   97.   98.   98.   99.
  100.  100.  101.  102.  103.  103.  105.  105.  106.  106.  107.  108.
  110.  110.  112.  113.  114.  114.  114.  115.  116.  117.  117.  118.
  118.  119.  119.  120.  121.  122.  123.  124.  124.  125.  126.  127.]
Original Output: [-528.022 -495.133 -416.571 -319.28  -242.816 -191.386 -179.126 -173.558
 -126.54   -90.249  -83.806  -58.14   -52.39   -48.935   26.544   26.806
   36.565   44.166   92.345  136.793  146.678  167.546  197.728  258.862
  264.144  279.464  302.466  357.551  362.639  428.086]
Quantized Output: [-26950.016 -25304.977 -21281.279 -16407.881 -12478.071  -9746.291
  -9198.291  -8795.919  -6482.953  -4715.834  -4313.012  -3038.813
  -2705.117  -2591.183   1308.967   1436.18    1882.777   2327.851
   4772.14    7043.739   7572.693   8707.154  10192.74   13194.87
  13547.099  14267.938  15252.001  18408.17   18451.922  21976.809]
Dequantized Output: [-527.08  -494.907 -416.213 -320.9   -244.042 -190.615 -179.897 -172.028
 -126.792  -92.231  -84.353  -59.432  -52.906  -50.678   25.6     28.088
   36.823   45.527   93.332  137.759  148.104  170.292  199.346  258.061
  264.95   279.048  298.294  360.021  360.877  429.816]
ðŸ”¹ Maximum difference: 4.172211548840323
ðŸ”¹ Minimum difference: 0.22585285047017578
ðŸ”¹ Relative error (for each element): [0.01  0.009 0.004 0.022 0.    0.045 0.014 0.001 0.007 0.007 0.002 0.011
 0.005 0.016 0.036 0.058 0.022 0.01  0.001 0.031 0.005 0.004 0.003 0.007
 0.002 0.008 0.003 0.009 0.004 0.007]
ðŸ”¹ Mean relative error: 0.0121197440110494
ðŸ”¹ Mean absolute error: 1.3252487542626588


