C:\Users\97253\AppData\Local\Programs\Python\Python311\python.exe "C:\Users\97253\OneDrive\שולחן העבודה\final project\Sketches-main\src\Quntize_one_layer_vector.py"
original x:tensor([ 6.5657e-01,  2.0000e+00,  1.0000e+03, -4.0000e+00, -5.0000e-01,
         6.1100e+00,  7.0000e+00,  8.0000e+00, -1.0000e+03,  4.5000e-01])
Original Weights:
[-0.314 -0.313 -0.313 -0.312 -0.311 -0.309 -0.305 -0.305 -0.304 -0.3
 -0.299 -0.298 -0.297 -0.296 -0.291 -0.29  -0.286 -0.285 -0.282 -0.279
 -0.278 -0.274 -0.272 -0.272 -0.27  -0.265 -0.264 -0.263 -0.262 -0.262
 -0.254 -0.252 -0.251 -0.249 -0.243 -0.242 -0.241 -0.231 -0.23  -0.229
 -0.228 -0.225 -0.224 -0.224 -0.221 -0.221 -0.22  -0.22  -0.217 -0.215
 -0.213 -0.208 -0.206 -0.205 -0.202 -0.2   -0.198 -0.196 -0.193 -0.191
 -0.188 -0.187 -0.186 -0.183 -0.175 -0.173 -0.173 -0.172 -0.172 -0.172
 -0.171 -0.169 -0.166 -0.165 -0.164 -0.163 -0.156 -0.155 -0.148 -0.143
 -0.14  -0.139 -0.136 -0.136 -0.136 -0.134 -0.131 -0.131 -0.13  -0.125
 -0.124 -0.123 -0.123 -0.121 -0.117 -0.116 -0.114 -0.113 -0.113 -0.108
 -0.108 -0.107 -0.104 -0.104 -0.103 -0.099 -0.098 -0.098 -0.097 -0.092
 -0.091 -0.09  -0.089 -0.081 -0.08  -0.08  -0.078 -0.078 -0.071 -0.07
 -0.064 -0.06  -0.052 -0.051 -0.049 -0.048 -0.048 -0.047 -0.045 -0.044
 -0.041 -0.034 -0.034 -0.026 -0.023 -0.02  -0.02  -0.02  -0.019 -0.019
 -0.018 -0.017 -0.015 -0.012 -0.011 -0.01   0.001  0.002  0.002  0.004
  0.005  0.007  0.013  0.013  0.018  0.022  0.024  0.026  0.033  0.035
  0.036  0.038  0.039  0.039  0.042  0.044  0.045  0.045  0.049  0.049
  0.05   0.055  0.055  0.057  0.058  0.058  0.059  0.06   0.062  0.064
  0.065  0.066  0.067  0.078  0.078  0.078  0.08   0.082  0.085  0.086
  0.086  0.088  0.088  0.089  0.09   0.093  0.094  0.094  0.097  0.099
  0.106  0.109  0.11   0.111  0.112  0.114  0.114  0.114  0.12   0.12
  0.122  0.123  0.124  0.126  0.131  0.137  0.137  0.142  0.143  0.146
  0.147  0.151  0.153  0.154  0.155  0.156  0.156  0.156  0.157  0.159
  0.159  0.162  0.162  0.163  0.171  0.172  0.173  0.174  0.184  0.187
  0.188  0.189  0.19   0.195  0.199  0.201  0.201  0.203  0.204  0.204
  0.205  0.21   0.211  0.211  0.212  0.213  0.215  0.216  0.22   0.22
  0.229  0.229  0.229  0.232  0.235  0.235  0.235  0.236  0.239  0.239
  0.239  0.241  0.245  0.246  0.246  0.248  0.25   0.252  0.254  0.256
  0.256  0.257  0.257  0.262  0.263  0.265  0.266  0.267  0.281  0.285
  0.286  0.286  0.288  0.293  0.294  0.295  0.295  0.313  0.314  0.315]
quantizedVec=[-32704 -32637 -32560 -32539 -32410 -32199 -31773 -31740 -31667 -31279
 -31188 -31038 -30964 -30787 -30265 -30174 -29757 -29729 -29345 -29110
 -28949 -28512 -28367 -28325 -28121 -27551 -27500 -27393 -27256 -27248
 -26417 -26211 -26159 -25955 -25358 -25215 -25140 -24012 -24007 -23875
 -23705 -23440 -23374 -23347 -23042 -23014 -22956 -22939 -22613 -22388
 -22234 -21633 -21456 -21316 -21001 -20863 -20642 -20365 -20116 -19898
 -19590 -19462 -19366 -19063 -18238 -18062 -18018 -17896 -17882 -17867
 -17771 -17627 -17283 -17222 -17043 -16931 -16229 -16177 -15414 -14906
 -14614 -14475 -14171 -14165 -14154 -13957 -13683 -13663 -13591 -12995
 -12964 -12832 -12816 -12572 -12171 -12125 -11845 -11812 -11807 -11251
 -11251 -11142 -10858 -10854 -10740 -10266 -10197 -10162 -10105  -9576
  -9493  -9412  -9239  -8395  -8344  -8301  -8106  -8086  -7388  -7286
  -6664  -6267  -5376  -5316  -5075  -5025  -5020  -4936  -4654  -4553
  -4275  -3542  -3506  -2727  -2370  -2116  -2116  -2112  -1970  -1950
  -1831  -1763  -1550  -1221  -1112  -1055     70    163    255    419
    483    711   1326   1364   1873   2298   2500   2688   3405   3676
   3698   3938   4022   4052   4375   4582   4676   4710   5108   5146
   5158   5719   5737   5963   6015   6039   6137   6268   6431   6671
   6757   6874   7014   8072   8074   8082   8330   8532   8884   8943
   8979   9117   9170   9297   9348   9674   9746   9805  10151  10315
  11034  11362  11506  11568  11710  11844  11898  11906  12475  12500
  12674  12853  12869  13071  13674  14289  14300  14806  14900  15228
  15263  15686  15902  16026  16132  16229  16261  16297  16359  16516
  16596  16842  16882  16957  17782  17895  18016  18123  19166  19493
  19603  19677  19744  20348  20751  20956  20959  21136  21237  21243
  21384  21874  21933  21934  22086  22217  22345  22523  22875  22922
  23815  23862  23870  24153  24455  24494  24526  24554  24846  24860
  24887  25150  25550  25637  25666  25819  26034  26286  26439  26653
  26667  26760  26814  27328  27372  27614  27712  27813  29246  29705
  29774  29798  29994  30548  30614  30718  30730  32593  32730  32829], scale=9.600856311663167e-06, z=0
dequantizedVec=[-0.314 -0.313 -0.313 -0.312 -0.311 -0.309 -0.305 -0.305 -0.304 -0.3
 -0.299 -0.298 -0.297 -0.296 -0.291 -0.29  -0.286 -0.285 -0.282 -0.279
 -0.278 -0.274 -0.272 -0.272 -0.27  -0.265 -0.264 -0.263 -0.262 -0.262
 -0.254 -0.252 -0.251 -0.249 -0.243 -0.242 -0.241 -0.231 -0.23  -0.229
 -0.228 -0.225 -0.224 -0.224 -0.221 -0.221 -0.22  -0.22  -0.217 -0.215
 -0.213 -0.208 -0.206 -0.205 -0.202 -0.2   -0.198 -0.196 -0.193 -0.191
 -0.188 -0.187 -0.186 -0.183 -0.175 -0.173 -0.173 -0.172 -0.172 -0.172
 -0.171 -0.169 -0.166 -0.165 -0.164 -0.163 -0.156 -0.155 -0.148 -0.143
 -0.14  -0.139 -0.136 -0.136 -0.136 -0.134 -0.131 -0.131 -0.13  -0.125
 -0.124 -0.123 -0.123 -0.121 -0.117 -0.116 -0.114 -0.113 -0.113 -0.108
 -0.108 -0.107 -0.104 -0.104 -0.103 -0.099 -0.098 -0.098 -0.097 -0.092
 -0.091 -0.09  -0.089 -0.081 -0.08  -0.08  -0.078 -0.078 -0.071 -0.07
 -0.064 -0.06  -0.052 -0.051 -0.049 -0.048 -0.048 -0.047 -0.045 -0.044
 -0.041 -0.034 -0.034 -0.026 -0.023 -0.02  -0.02  -0.02  -0.019 -0.019
 -0.018 -0.017 -0.015 -0.012 -0.011 -0.01   0.001  0.002  0.002  0.004
  0.005  0.007  0.013  0.013  0.018  0.022  0.024  0.026  0.033  0.035
  0.036  0.038  0.039  0.039  0.042  0.044  0.045  0.045  0.049  0.049
  0.05   0.055  0.055  0.057  0.058  0.058  0.059  0.06   0.062  0.064
  0.065  0.066  0.067  0.077  0.078  0.078  0.08   0.082  0.085  0.086
  0.086  0.088  0.088  0.089  0.09   0.093  0.094  0.094  0.097  0.099
  0.106  0.109  0.11   0.111  0.112  0.114  0.114  0.114  0.12   0.12
  0.122  0.123  0.124  0.125  0.131  0.137  0.137  0.142  0.143  0.146
  0.147  0.151  0.153  0.154  0.155  0.156  0.156  0.156  0.157  0.159
  0.159  0.162  0.162  0.163  0.171  0.172  0.173  0.174  0.184  0.187
  0.188  0.189  0.19   0.195  0.199  0.201  0.201  0.203  0.204  0.204
  0.205  0.21   0.211  0.211  0.212  0.213  0.215  0.216  0.22   0.22
  0.229  0.229  0.229  0.232  0.235  0.235  0.235  0.236  0.239  0.239
  0.239  0.241  0.245  0.246  0.246  0.248  0.25   0.252  0.254  0.256
  0.256  0.257  0.257  0.262  0.263  0.265  0.266  0.267  0.281  0.285
  0.286  0.286  0.288  0.293  0.294  0.295  0.295  0.313  0.314  0.315]
-------------------------------------------------------------------
Quantization Grid - Max: 32767, Min: -32767
Quantized Weights:
[-32642. -32575. -32499. -32477. -32349. -32138. -31713. -31680. -31608.
 -31220. -31129. -30979. -30905. -30729. -30208. -30117. -29701. -29673.
 -29290. -29055. -28894. -28459. -28314. -28271. -28068. -27499. -27448.
 -27342. -27204. -27196. -26367. -26162. -26109. -25906. -25310. -25167.
 -25093. -23967. -23962. -23830. -23661. -23396. -23330. -23303. -22999.
 -22971. -22913. -22896. -22571. -22346. -22192. -21592. -21416. -21276.
 -20961. -20824. -20603. -20327. -20078. -19861. -19553. -19426. -19329.
 -19027. -18204. -18029. -17984. -17862. -17848. -17834. -17738. -17593.
 -17250. -17189. -17011. -16899. -16199. -16147. -15385. -14878. -14587.
 -14448. -14145. -14138. -14128. -13931. -13657. -13637. -13565. -12971.
 -12940. -12808. -12792. -12548. -12149. -12103. -11823. -11790. -11785.
 -11230. -11230. -11121. -10838. -10833. -10720. -10247. -10178. -10143.
 -10086.  -9558.  -9475.  -9395.  -9221.  -8379.  -8329.  -8286.  -8091.
  -8071.  -7375.  -7272.  -6652.  -6256.  -5366.  -5306.  -5066.  -5016.
  -5011.  -4927.  -4646.  -4545.  -4267.  -3536.  -3500.  -2722.  -2366.
  -2113.  -2112.  -2109.  -1967.  -1947.  -1828.  -1760.  -1548.  -1219.
  -1111.  -1054.     71.    163.    255.    419.    483.    710.   1324.
   1362.   1870.   2295.   2496.   2684.   3399.   3670.   3692.   3931.
   4015.   4045.   4367.   4574.   4668.   4701.   5099.   5136.   5149.
   5708.   5726.   5952.   6004.   6028.   6125.   6257.   6419.   6659.
   6744.   6861.   7001.   8058.   8059.   8068.   8315.   8516.   8868.
   8927.   8963.   9100.   9153.   9280.   9331.   9656.   9728.   9787.
  10132.  10296.  11014.  11341.  11485.  11546.  11688.  11822.  11876.
  11884.  12452.  12477.  12650.  12829.  12845.  13047.  13649.  14262.
  14274.  14778.  14872.  15200.  15235.  15656.  15872.  15996.  16101.
  16199.  16231.  16267.  16328.  16485.  16565.  16810.  16850.  16925.
  17749.  17862.  17982.  18089.  19130.  19456.  19566.  19640.  19706.
  20310.  20712.  20917.  20920.  21096.  21197.  21203.  21344.  21833.
  21891.  21893.  22044.  22175.  22303.  22481.  22832.  22879.  23770.
  23817.  23825.  24107.  24409.  24448.  24480.  24508.  24800.  24813.
  24840.  25102.  25501.  25589.  25617.  25770.  25985.  26236.  26389.
  26603.  26617.  26710.  26764.  27277.  27321.  27562.  27660.  27761.
  29191.  29649.  29718.  29742.  29937.  30491.  30556.  30660.  30672.
  32531.  32669.  32767.]
Original Output: [-564.888 -373.519 -348.462 -288.934 -204.304 -110.937  -98.818  -69.464
  -69.291  -63.7    -44.909  -21.529   -7.224   -4.904   28.625   61.096
   82.798   88.066   92.838  103.768  108.142  118.064  120.519  121.41
  140.902  170.283  219.422  380.93   492.49   500.887]
Quantized Output: [-1.924e+09 -1.272e+09 -1.187e+09 -9.842e+08 -6.967e+08 -3.789e+08
 -3.372e+08 -2.375e+08 -2.351e+08 -2.172e+08 -1.531e+08 -7.365e+07
 -2.421e+07 -1.570e+07  9.670e+07  2.074e+08  2.824e+08  2.991e+08
  3.169e+08  3.545e+08  3.685e+08  4.032e+08  4.106e+08  4.128e+08
  4.799e+08  5.796e+08  7.467e+08  1.298e+09  1.679e+09  1.706e+09]
Dequantized Output: [-564.949 -373.456 -348.378 -288.93  -204.528 -111.229  -98.975  -69.714
  -69.005  -63.763  -44.931  -21.621   -7.106   -4.608   28.386   60.875
   82.898   87.815   93.025  104.074  108.171  118.361  120.547  121.183
  140.871  170.136  219.212  381.141  492.777  500.735]
🔹 Maximum difference: 0.3057840027152281
🔹 Minimum difference: 0.00413176652597258
🔹 Relative error (for each element): [2.181e-04 5.530e-04 3.609e-03 2.673e-04 8.584e-04 2.627e-03 9.829e-04
 1.081e-04 4.127e-03 8.315e-03 2.385e-04 1.628e-02 1.201e-03 2.514e-03
 3.603e-03 5.820e-04 9.555e-04 4.294e-03 2.847e-03 1.096e-03 6.029e-02
 2.015e-03 1.683e-04 3.039e-04 4.987e-04 2.947e-03 1.587e-03 1.430e-05
 1.869e-03 2.424e-04]
🔹 Mean relative error: 0.004173450051499513
🔹 Mean absolute error: 0.1643489966744568


