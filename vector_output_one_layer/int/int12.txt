C:\Users\97253\AppData\Local\Programs\Python\Python311\python.exe "C:\Users\97253\OneDrive\×©×•×œ×—×Ÿ ×”×¢×‘×•×“×”\final project\Sketches-main\src\Quntize_one_layer_vector.py" 
original x:tensor([ 6.5657e-01,  2.0000e+00,  1.0000e+03, -4.0000e+00, -5.0000e-01,
         6.1100e+00,  7.0000e+00,  8.0000e+00, -1.0000e+03,  4.5000e-01])
Original Weights:
[-0.316 -0.315 -0.314 -0.311 -0.305 -0.303 -0.299 -0.299 -0.291 -0.291
 -0.29  -0.29  -0.286 -0.286 -0.284 -0.283 -0.275 -0.273 -0.271 -0.266
 -0.266 -0.264 -0.263 -0.262 -0.26  -0.25  -0.249 -0.242 -0.242 -0.237
 -0.237 -0.236 -0.236 -0.234 -0.231 -0.228 -0.224 -0.224 -0.219 -0.218
 -0.217 -0.217 -0.206 -0.204 -0.203 -0.203 -0.203 -0.202 -0.202 -0.199
 -0.192 -0.19  -0.189 -0.188 -0.187 -0.186 -0.185 -0.182 -0.181 -0.18
 -0.174 -0.173 -0.172 -0.169 -0.166 -0.165 -0.161 -0.16  -0.157 -0.155
 -0.151 -0.146 -0.143 -0.142 -0.14  -0.14  -0.14  -0.138 -0.136 -0.135
 -0.132 -0.13  -0.125 -0.122 -0.122 -0.122 -0.12  -0.118 -0.117 -0.117
 -0.116 -0.115 -0.111 -0.111 -0.11  -0.11  -0.109 -0.107 -0.106 -0.103
 -0.102 -0.101 -0.101 -0.1   -0.1   -0.097 -0.092 -0.09  -0.089 -0.089
 -0.089 -0.088 -0.083 -0.082 -0.08  -0.077 -0.075 -0.074 -0.074 -0.072
 -0.068 -0.066 -0.062 -0.061 -0.061 -0.061 -0.058 -0.058 -0.052 -0.051
 -0.05  -0.045 -0.044 -0.043 -0.043 -0.042 -0.04  -0.032 -0.026 -0.025
 -0.023 -0.021 -0.02  -0.013 -0.011 -0.009 -0.008 -0.007 -0.002  0.001
  0.002  0.004  0.005  0.009  0.011  0.018  0.019  0.019  0.021  0.029
  0.03   0.031  0.033  0.036  0.041  0.044  0.045  0.047  0.05   0.057
  0.059  0.059  0.063  0.066  0.069  0.071  0.072  0.078  0.086  0.089
  0.09   0.094  0.095  0.096  0.096  0.099  0.102  0.108  0.112  0.113
  0.116  0.117  0.117  0.118  0.123  0.125  0.126  0.127  0.128  0.128
  0.128  0.128  0.129  0.129  0.13   0.134  0.138  0.14   0.142  0.143
  0.146  0.148  0.149  0.15   0.152  0.154  0.157  0.158  0.158  0.159
  0.161  0.165  0.171  0.172  0.173  0.181  0.182  0.186  0.19   0.19
  0.19   0.193  0.193  0.196  0.199  0.202  0.204  0.205  0.209  0.21
  0.211  0.212  0.218  0.218  0.22   0.22   0.221  0.224  0.226  0.227
  0.228  0.228  0.229  0.229  0.234  0.235  0.236  0.237  0.239  0.243
  0.247  0.248  0.248  0.251  0.251  0.253  0.256  0.259  0.261  0.262
  0.267  0.269  0.271  0.273  0.274  0.278  0.278  0.287  0.29   0.291
  0.294  0.294  0.295  0.295  0.295  0.295  0.296  0.296  0.297  0.298
  0.299  0.301  0.303  0.306  0.307  0.31   0.311  0.312  0.313  0.315]
quantizedVec=[-2050 -2046 -2037 -2016 -1979 -1965 -1942 -1941 -1890 -1885 -1882 -1880
 -1856 -1853 -1839 -1837 -1786 -1772 -1760 -1726 -1725 -1714 -1705 -1702
 -1687 -1623 -1616 -1572 -1568 -1539 -1536 -1530 -1528 -1519 -1498 -1479
 -1452 -1450 -1421 -1416 -1407 -1406 -1338 -1324 -1319 -1318 -1313 -1308
 -1308 -1291 -1246 -1235 -1222 -1216 -1210 -1207 -1202 -1181 -1176 -1169
 -1130 -1122 -1112 -1099 -1078 -1072 -1044 -1035 -1016 -1005  -979  -950
  -925  -922  -910  -910  -910  -898  -881  -878  -857  -843  -811  -792
  -791  -788  -776  -763  -757  -757  -754  -743  -718  -718  -714  -713
  -708  -693  -684  -670  -662  -658  -653  -648  -647  -629  -599  -584
  -579  -579  -574  -573  -538  -528  -518  -501  -485  -482  -480  -469
  -443  -429  -401  -397  -397  -393  -375  -375  -337  -331  -325  -291
  -286  -280  -276  -275  -259  -207  -168  -159  -146  -135  -130   -85
   -71   -59   -50   -43   -13     7    13    24    33    58    69   116
   120   123   139   190   193   202   215   236   268   286   288   303
   326   370   381   381   408   431   445   462   464   507   556   579
   582   610   617   620   621   641   660   698   728   729   755   758
   761   768   795   812   814   824   831   831   831   833   834   834
   843   870   892   907   920   928   945   958   967   973   983   996
  1021  1023  1027  1028  1042  1072  1111  1116  1121  1172  1183  1207
  1232  1232  1234  1250  1252  1273  1287  1308  1322  1327  1358  1365
  1366  1376  1415  1416  1424  1427  1430  1451  1467  1472  1481  1481
  1487  1488  1517  1525  1528  1537  1550  1575  1601  1606  1609  1626
  1629  1638  1660  1678  1693  1698  1730  1742  1756  1771  1779  1802
  1804  1859  1878  1889  1907  1908  1911  1911  1912  1913  1919  1922
  1924  1932  1941  1950  1963  1985  1993  2012  2014  2024  2028  2043], scale=0.00015418143405178202, z=0
dequantizedVec=[-0.316 -0.315 -0.314 -0.311 -0.305 -0.303 -0.299 -0.299 -0.291 -0.291
 -0.29  -0.29  -0.286 -0.286 -0.284 -0.283 -0.275 -0.273 -0.271 -0.266
 -0.266 -0.264 -0.263 -0.262 -0.26  -0.25  -0.249 -0.242 -0.242 -0.237
 -0.237 -0.236 -0.236 -0.234 -0.231 -0.228 -0.224 -0.224 -0.219 -0.218
 -0.217 -0.217 -0.206 -0.204 -0.203 -0.203 -0.202 -0.202 -0.202 -0.199
 -0.192 -0.19  -0.188 -0.187 -0.187 -0.186 -0.185 -0.182 -0.181 -0.18
 -0.174 -0.173 -0.171 -0.169 -0.166 -0.165 -0.161 -0.16  -0.157 -0.155
 -0.151 -0.146 -0.143 -0.142 -0.14  -0.14  -0.14  -0.138 -0.136 -0.135
 -0.132 -0.13  -0.125 -0.122 -0.122 -0.121 -0.12  -0.118 -0.117 -0.117
 -0.116 -0.115 -0.111 -0.111 -0.11  -0.11  -0.109 -0.107 -0.105 -0.103
 -0.102 -0.101 -0.101 -0.1   -0.1   -0.097 -0.092 -0.09  -0.089 -0.089
 -0.089 -0.088 -0.083 -0.081 -0.08  -0.077 -0.075 -0.074 -0.074 -0.072
 -0.068 -0.066 -0.062 -0.061 -0.061 -0.061 -0.058 -0.058 -0.052 -0.051
 -0.05  -0.045 -0.044 -0.043 -0.043 -0.042 -0.04  -0.032 -0.026 -0.025
 -0.023 -0.021 -0.02  -0.013 -0.011 -0.009 -0.008 -0.007 -0.002  0.001
  0.002  0.004  0.005  0.009  0.011  0.018  0.019  0.019  0.021  0.029
  0.03   0.031  0.033  0.036  0.041  0.044  0.044  0.047  0.05   0.057
  0.059  0.059  0.063  0.066  0.069  0.071  0.072  0.078  0.086  0.089
  0.09   0.094  0.095  0.096  0.096  0.099  0.102  0.108  0.112  0.112
  0.116  0.117  0.117  0.118  0.123  0.125  0.126  0.127  0.128  0.128
  0.128  0.128  0.129  0.129  0.13   0.134  0.138  0.14   0.142  0.143
  0.146  0.148  0.149  0.15   0.152  0.154  0.157  0.158  0.158  0.158
  0.161  0.165  0.171  0.172  0.173  0.181  0.182  0.186  0.19   0.19
  0.19   0.193  0.193  0.196  0.198  0.202  0.204  0.205  0.209  0.21
  0.211  0.212  0.218  0.218  0.22   0.22   0.22   0.224  0.226  0.227
  0.228  0.228  0.229  0.229  0.234  0.235  0.236  0.237  0.239  0.243
  0.247  0.248  0.248  0.251  0.251  0.253  0.256  0.259  0.261  0.262
  0.267  0.269  0.271  0.273  0.274  0.278  0.278  0.287  0.29   0.291
  0.294  0.294  0.295  0.295  0.295  0.295  0.296  0.296  0.297  0.298
  0.299  0.301  0.303  0.306  0.307  0.31   0.311  0.312  0.313  0.315]
-------------------------------------------------------------------
Quantization Grid - Max: 2047, Min: -2047
Quantized Weights:
[-2047. -2042. -2033. -2013. -1976. -1962. -1939. -1938. -1887. -1881.
 -1879. -1877. -1852. -1850. -1836. -1834. -1783. -1769. -1757. -1723.
 -1722. -1711. -1703. -1699. -1684. -1620. -1614. -1569. -1565. -1537.
 -1533. -1527. -1525. -1517. -1496. -1476. -1450. -1448. -1419. -1414.
 -1405. -1403. -1336. -1322. -1317. -1316. -1311. -1306. -1306. -1289.
 -1244. -1233. -1221. -1215. -1208. -1205. -1200. -1179. -1175. -1167.
 -1128. -1121. -1111. -1097. -1076. -1070. -1042. -1033. -1015. -1004.
  -978.  -948.  -924.  -921.  -909.  -909.  -909.  -896.  -880.  -877.
  -856.  -842.  -810.  -791.  -790.  -787.  -775.  -762.  -756.  -756.
  -753.  -742.  -717.  -717.  -713.  -712.  -708.  -692.  -683.  -669.
  -662.  -657.  -653.  -647.  -646.  -628.  -598.  -583.  -578.  -578.
  -574.  -573.  -538.  -528.  -517.  -500.  -484.  -481.  -479.  -469.
  -443.  -429.  -401.  -397.  -397.  -393.  -375.  -375.  -337.  -331.
  -325.  -291.  -286.  -280.  -276.  -275.  -259.  -207.  -168.  -160.
  -146.  -135.  -130.   -85.   -72.   -59.   -50.   -43.   -13.     8.
    13.    25.    33.    58.    69.   116.   120.   124.   139.   190.
   193.   202.   215.   236.   268.   286.   288.   303.   326.   370.
   381.   381.   407.   430.   445.   461.   464.   507.   555.   579.
   581.   610.   616.   620.   620.   641.   660.   697.   728.   728.
   754.   757.   760.   767.   794.   811.   813.   823.   830.   830.
   830.   832.   833.   833.   842.   869.   891.   906.   919.   927.
   943.   956.   966.   971.   981.   994.  1019.  1022.  1026.  1026.
  1041.  1071.  1109.  1114.  1119.  1170.  1181.  1205.  1230.  1230.
  1232.  1248.  1250.  1271.  1285.  1306.  1320.  1325.  1356.  1363.
  1364.  1374.  1413.  1413.  1421.  1425.  1428.  1449.  1465.  1470.
  1479.  1479.  1484.  1486.  1514.  1523.  1526.  1534.  1547.  1573.
  1598.  1603.  1607.  1623.  1627.  1635.  1657.  1675.  1690.  1695.
  1727.  1740.  1753.  1768.  1777.  1799.  1801.  1856.  1875.  1886.
  1904.  1905.  1908.  1908.  1909.  1910.  1916.  1919.  1921.  1929.
  1938.  1947.  1959.  1982.  1990.  2009.  2010.  2021.  2025.  2039.]
Original Output: [-520.472 -492.05  -430.575 -339.467 -318.382 -252.632 -226.011 -222.456
 -178.983 -133.504 -132.242 -128.737 -125.588 -117.683  -82.656  -73.718
  -73.08   -62.229  -57.859   16.931   18.045   34.076   60.511   82.011
  153.329  249.647  256.93   318.164  335.183  397.759]
Quantized Output: [-6893771.    -6517356.    -5703086.5   -4495310.    -4216389.
 -3346788.    -2992284.25  -2945952.    -2373772.75  -1768579.125
 -1753212.875 -1707751.75  -1660053.375 -1561335.75  -1090710.125
  -980675.75   -969093.875  -823030.062  -770070.938   226933.938
   243011.938   448185.25    802211.062  1085535.     2033415.75
  3312541.75   3400709.25   4219723.     4446829.5    5271340.   ]
Dequantized Output: [-520.235 -491.829 -430.381 -339.236 -318.188 -252.564 -225.811 -222.315
 -179.136 -133.465 -132.305 -128.875 -125.275 -117.825  -82.31   -74.006
  -73.132  -62.11   -58.113   17.125   18.339   33.822   60.538   81.919
  153.451  249.979  256.633  318.439  335.578  397.799]
ðŸ”¹ Maximum difference: 0.395056209632628
ðŸ”¹ Minimum difference: 0.027884535753649686
ðŸ”¹ Relative error (for each element): [0.001 0.    0.    0.004 0.    0.016 0.001 0.    0.001 0.001 0.001 0.001
 0.001 0.007 0.002 0.001 0.001 0.001 0.001 0.001 0.012 0.    0.    0.001
 0.    0.004 0.    0.002 0.004 0.001]
ðŸ”¹ Mean relative error: 0.0022738753758499352
ðŸ”¹ Mean absolute error: 0.19065771592409309

Process finished with exit code 0
